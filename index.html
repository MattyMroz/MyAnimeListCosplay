<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Dynamiczny kolor tła</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        #container {
            transition: background-color 0.5s ease;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #sourceImage {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
    </style>
</head>

<body>
    <div id="container">
        <img id="sourceImage"
            src="https://cdn.discordapp.com/attachments/1076133296557269072/1261809710240108574/OIG12.png?ex=66acb31e&is=66ab619e&hm=029793fe9ecad63865596b1dc0fda9dd9505393daf5e653e93a4eb2b69908ebb&"
            alt="Źródłowy obrazek" crossorigin="anonymous">
        <img id="sourceImage"
            src="https://cdn.discordapp.com/attachments/1076133296557269072/1259942138452643840/4f1cc59654a9d7c99e8e31720c0b7914.png?ex=66ac7f4e&is=66ab2dce&hm=b8ba9b87ac01b28ed9742be4ab2cd8989ecde903ff6ba079b6ce971a84346d49&"
            alt="Źródłowy obrazek" crossorigin="anonymous">
    </div>

    <script>
        function getAverageColor(img) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.drawImage(img, 0, 0);

            try {
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                let r = 0, g = 0, b = 0;

                for (let i = 0; i < data.length; i += 4) {
                    r += data[i];
                    g += data[i + 1];
                    b += data[i + 2];
                }

                r = Math.floor(r / (data.length / 4));
                g = Math.floor(g / (data.length / 4));
                b = Math.floor(b / (data.length / 4));

                // Znajdź dominujący kolor i dodaj do niego 1000
                const max = Math.max(r, g, b);
                if (r === max) r += 1000;
                else if (g === max) g += 1000;
                else b += 1000;

                return [r, g, b];
            } catch (e) {
                console.error("Błąd podczas przetwarzania obrazu:", e);
                return [0, 0, 0]; // Domyślny kolor w przypadku błędu
            }
        }

        const img = document.getElementById('sourceImage');
        const container = document.getElementById('container');

        img.onload = function () {
            const avgColor = getAverageColor(img);
            container.style.backgroundColor = `rgb(${Math.min(avgColor[0], 255)}, ${Math.min(avgColor[1], 255)}, ${Math.min(avgColor[2], 255)})`;
        };

        // Jeśli obrazek jest już załadowany, wywołaj funkcję ręcznie
        if (img.complete) {
            img.onload();
        }
    </script>
</body>

</html>